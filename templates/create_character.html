{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-dark text-white">
                    <h3 class="mb-0"><i class="fas fa-user-plus"></i> Criar Personagem Importante</h3>
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data" action="/create_character">
                        <!-- Informações Básicas -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="name" class="form-label"><i class="fas fa-user"></i> Nome do Personagem</label>
                                    <input type="text" class="form-control" id="name" name="name" required placeholder="Digite o nome do personagem">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="race" class="form-label"><i class="fas fa-dragon"></i> Raça</label>
                                    <select class="form-select" id="race" name="race" required onchange="toggleVampireFields()">
                                        <option value="vampiro">Vampiro</option>
                                        <option value="humano">Humano</option>
                                        <option value="demonio">Demônio</option>
                                        <option value="lobisomen">Lobisomen</option>
                                        <option value="celestial">Celestial</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- Campos específicos para Vampiros -->
                        <div class="row" id="vampire-fields" style="display:none;">
                            <div class="col-md-6">
                                <div class="mb-3" id="clan-field">
                                    <label for="clan" class="form-label"><i class="fas fa-crown"></i> Clã</label>
                                    <select class="form-select" id="clan" name="clan">
                                        <option value="Não Afiliado">Não Afiliado</option>
                                        <option value="Assamitas">Assamitas</option>
                                        <option value="Brujah">Brujah</option>
                                        <option value="Gangrel">Gangrel</option>
                                        <option value="Giovanni">Giovanni</option>
                                        <option value="Lasombra">Lasombra</option>
                                        <option value="Malkavianos">Malkavianos</option>
                                        <option value="Nosferatu">Nosferatu</option>
                                        <option value="Ravnos">Ravnos</option>
                                        <option value="Seguidores de set">Seguidores de Set</option>
                                        <option value="Toreador">Toreador</option>
                                        <option value="Tremere">Tremere</option>
                                        <option value="Tzmisce">Tzimisce</option>
                                        <option value="Ventrue">Ventrue</option>
                                        <option value="Caitiff">Caitiff</option>
                                        <option value="Sangue-ralo">Sangue-ralo</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3" id="bloodline-field">
                                    <label for="bloodline" class="form-label"><i class="fas fa-dna"></i> Geração</label>
                                    <select class="form-select" id="bloodline" name="bloodline">
                                        <option value="1º Geração">1º Geração</option>
                                        <option value="2º Geração">2º Geração</option>
                                        <option value="3º Geração">3º Geração</option>
                                        <option value="4º Geração">4º Geração</option>
                                        <option value="5º Geração">5º Geração</option>
                                        <option value="6º Geração">6º Geração</option>
                                        <option value="7º Geração">7º Geração</option>
                                        <option value="8º Geração">8º Geração</option>
                                        <option value="9º Geração">9º Geração</option>
                                        <option value="10º Geração">10º Geração</option>
                                        <option value="11º Geração">11º Geração</option>
                                        <option value="12º Geração">12º Geração</option>
                                        <option value="13º Geração">13º Geração</option>
                                        <option value="14º Geração">14º Geração</option>
                                        <option value="15º Geração">15º Geração</option>
                                        <option value="sangue-ralo">Sangue-Ralo</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- Descrição Geral -->
                        <div class="mb-4">
                            <label for="description" class="form-label"><i class="fas fa-file-alt"></i> Descrição Geral</label>
                            <textarea class="form-control" id="description" name="description" rows="4" required placeholder="Descreva a aparência física e características gerais do personagem..."></textarea>
                        </div>

                        <!-- Campos Detalhados -->
                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="personalidade" class="form-label"><i class="fas fa-brain"></i> Personalidade</label>
                                    <textarea class="form-control" id="personalidade" name="personalidade" rows="3" placeholder="Descreva a personalidade, comportamentos, maneirismos e características psicológicas..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="poderes_habilidades" class="form-label"><i class="fas fa-magic"></i> Poderes e Habilidades</label>
                                    <textarea class="form-control" id="poderes_habilidades" name="poderes_habilidades" rows="3" placeholder="Liste os poderes, disciplinas, habilidades especiais e competências do personagem..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="conexoes" class="form-label"><i class="fas fa-users"></i> Conexões</label>
                                    <textarea class="form-control" id="conexoes" name="conexoes" rows="3" placeholder="Descreva relacionamentos, aliados, inimigos, contatos e vínculos importantes..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Campo de Imagem -->
                        <div class="mb-4">
                            <label for="image" class="form-label"><i class="fas fa-image"></i> Imagem do Personagem</label>
                            <input class="form-control" type="file" id="image" name="image" accept="image/*">
                            <div class="form-text">Formatos aceitos: JPG, PNG, GIF (máximo 5MB)</div>
                        </div>

                        <!-- Botões -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{{ url_for('admin_characters') }}" class="btn btn-secondary me-md-2">
                                <i class="fas fa-arrow-left"></i> Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Criar Personagem
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript para controlar a visibilidade dos campos -->
<script>
    function toggleVampireFields() {
        var race = document.getElementById("race").value;
        var vampireFields = document.getElementById("vampire-fields");

        // Mostrar campos específicos apenas para Vampiros
        if (race === "vampiro") {
            vampireFields.style.display = "block";
        } else {
            vampireFields.style.display = "none";
        }
    }

    // Executar ao carregar a página para garantir que a seleção inicial esteja correta
    document.addEventListener("DOMContentLoaded", function() {
        toggleVampireFields();
        
        // Adicionar validação de arquivo
        document.getElementById('image').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                if (file.size > 5 * 1024 * 1024) { // 5MB
                    alert('O arquivo deve ter no máximo 5MB');
                    e.target.value = '';
                }
            }
        });
    });
</script>

<style>
    .card {
        border: none;
        border-radius: 15px;
    }
    
    .card-header {
        border-radius: 15px 15px 0 0 !important;
    }
    
    .form-control, .form-select {
        border-radius: 8px;
        border: 1px solid #ddd;
        transition: all 0.3s ease;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }
    
    .form-label {
        font-weight: 600;
        color: #333;
    }
    
    .btn {
        border-radius: 8px;
        padding: 10px 20px;
        font-weight: 500;
    }
    
    .shadow {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    }
</style>
{% endblock %}

